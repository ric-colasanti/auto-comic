<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <title>The Robots</title>

    <style>
        #rarm {
            transform: scaleX(-.1);
        }

        svg {
            font-family: "Helvetica", "Arial", sans-serif;
        }

        .jumbotron {
            background-image: url("img/living.jpg");
            background-size: cover;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="jumbotron" >
            <div style="background-color: aliceblue;width:500px; padding-left:10px;padding-bottom:1px">
                <h1>The Robots</h1>  
                <p>Your autogenerated comic pals!</p>
            </div>    
          </div>
        <div class="row">
            <div class="col-sm-8">
                <svg id="svg01" width="540" height="300" style="border-style: solid;">
                </svg>
            </div>    
            <div class="col-sm-4">
                <textarea id="textarea1" rows="12" cols="40">
living.jpg
red,blue 
red"We are the robots":happy
blue"You can program us by typing commands in to the text box on the right":eyesright
red"You run the program by clicking the submit button"
red"Now on with the show"
                </textarea>
                <button class="btn btn-primary" onclick="submitText('svg01','textarea1') ">Submit</button>
            </div><!-- col -->   
            
     
        </div><!-- row-->
    <br>



        <div class="row">
            <div class="col-sm-8">
                <svg id="svg02" width="540" height="300" style="border-style: solid;">
                </svg>
            </div>    
            <div class="col-sm-4">
                <textarea id="textarea2" rows="12" cols="40">
kitchen.png 
blue,red
blue"Red why are you so sad?":eyesright:headright
red"Two of my favourite numbers have had a fight":sad:eyesleft
blue"Who are they?"
red"19 and 20"
blue"What happened?"
</textarea>
<button class="btn btn-primary" onclick="submitText('svg02','textarea2') ">Submit</button>
</div><!-- col -->   


</div><!-- row-->
<br>



    <div class="row">
        <div class="col-sm-8">
            <svg id="svg03" width="540" height="300" style="border-style: solid;">
            </svg>
        </div>    
        <div class="col-sm-4">
            <textarea id="textarea3" rows="12" cols="40">
kitchen.png 
blue,red
red"21":eyesleft:headleft
blue"?":cross:eyesright:headleft
</textarea>
<button class="btn btn-primary" onclick="submitText('svg03','textarea3') ">Submit</button>
</div><!-- col -->   


</div><!-- row-->
<br>




<div class="row">
    <div class="col-sm-8">
        <svg id="svg04" width="540" height="300" style="border-style: solid;">
        </svg>
    </div>    
    <div class="col-sm-4">
        <textarea id="textarea4" rows="12" cols="40">
kitchen.png 
blue,red
red"Twenty Won !!":happy:eyesleft:headleft
blue"Ha Ha Ha!":happy:eyesup
blue"You are a joke telling machine!":happy:eyesup
</textarea>
<button class="btn btn-primary onclick="submitText('svg04','textarea4') ">Submit</button>
</div><!-- col -->   


</div><!-- row-->
<br>


</div> <!-- container -->
<!-- <p>This work took insparation from <a href="https://www.kesiev.com/stripthis/">Strip this</a></p>
<p>A large part of the SVG coding for the Robots was taken from <a href="https://codepen.io/wattenberger/pen/Bksoc">Wattenberger</a>. Many thanks. </p>
<p>The <a href="https://www.beano.com/posts/number-jokes">BEANO</a> was the basis of the number joke.</p>
<p>The backgrounds are open source from <a href="https://www.needpix.com/photo/514692/kitchen-room-kitchen-interior-appliance-furnitures-cupboard-cabinets-stove-table">Needpix</a> and <a href="https://www.nextdayblinds.com/ndb-flickr/">NextDayBlinds.</a></p> -->
</body>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<script src="js/robot.js"></script>
<script>
    if(typeof(String.prototype.trim) === "undefined")
{
    String.prototype.trim = function() 
    {
        return String(this).replace(/^\s+|\s+$/g, '');
    };
}
    function submitText(svgId, textId) {
        console.log()
        var elm = document.getElementById(svgId);
        var frame = SVG("g");
        while (frame.firstChild) {
            frame.removeChild(frame.firstChild);
        }
        elm.appendChild(frame)
        // Set background
        var textAreas = document.getElementById(textId);
        var comic = textAreas.value.split('\n')
        var bground = SVG("image")
        bground.setAttribute('href', "img/"+comic[0]);
        bground.setAttribute("width", "100%")
        frame.appendChild(bground)
        
        
        // Create robots
        //console.log("bots0")
        var robots={
            red:{
                order:0, 
                bot:new Robot("#94627D", "#657F8E", "thin")
                },            
            blue:{
                order:0, 
                bot:new Robot("#6469AD", "#009a9E", "fat")
                },
        }
        //console.log("bots1")
        
        // Speech and expressions
        chars = comic[1].split(",")
        var pos = 10
        var c = 0
        for (c = 0; c < chars.length; c++) {
            var key = chars[c].trim()
            robots[key].order = c+1;
            frame.appendChild(robots[key].bot.robotGroup);
            height = robots[key].bot.robotGroup.getBBox().height
            robots[key].bot.position(height, 10 + (c*360), 300)
        }
        for (i = 2; i < comic.length; i++) {
            scomic = comic[i].split('"');
            var key = scomic[0].trim()
            //console.log(key)
            if(robots[key]!=undefined){
                //console.log(scomic[1])
                var speechBubble = new SpeechBubble(scomic[1], robots[key].bot.bodyColor)
                frame.appendChild(speechBubble.group)
                var xPos = 160
                if (robots[key].order == 1) {
                    xPos = 190
                }
                speechBubble.group.setAttribute("transform", "translate(" + xPos + "," + pos + ")")
                pos += speechBubble.group.getBBox().height + 20
                expressions = comic[i].split(":")
                for (e in expressions) {
                    robots[key].bot.expression(expressions[e]);
                }
            }
        }    

    }



    submitText("svg01","textarea1");
    submitText("svg02","textarea2");
    submitText("svg03","textarea3");
    submitText("svg04","textarea4");
</script>

</html>